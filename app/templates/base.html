<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

  <!-- Choices.js CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Custom styles -->
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">

  <title>{% block title %}IHC image gallery{% endblock %}</title>
</head>

<body>

  <header>
    <div class="container">
      <div class="header-content">
        <a href="/" class="logo">IHC-Gallery</a>
        <div class="nav-container">
          <nav>
            <a href="/">Home</a>
            <a href="/search" class="active">Search</a>
            <a href="/upload">Upload</a>
            <a href="/gallery">Gallery</a>
          </nav>
          <button class="theme-toggle" aria-label="Toggle theme">
            <i class="fas fa-sun sun-icon"></i>
            <i class="fas fa-moon moon-icon"></i>
          </button>
          <button class="mobile-menu-button" aria-label="Open menu">
            <i class="fas fa-bars"></i>
          </button>
        </div>
      </div>
    </div>
  </header>

  <div class="mobile-menu">
    <button class="mobile-menu-close" aria-label="Close menu">
      <i class="fas fa-times"></i>
    </button>
    <a href="/">Home</a>
    <a href="/search">Search</a>
    <a href="/upload">Upload</a>
    <a href="/gallery" class="active">Gallery</a>
  </div>
  <div class="overlay"></div>

  <main>
    {% block content %}{% endblock %}
  </main>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

  <!-- Choices.js -->
  <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

  <script>
    // Theme toggle functionality
    const themeToggle = document.querySelector('.theme-toggle');
    const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    const currentTheme = localStorage.getItem('theme') || (prefersDarkScheme.matches ? 'dark' : 'light');

    if (currentTheme === 'dark') {
      document.body.classList.add('dark');
    }

    themeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark');
      const theme = document.body.classList.contains('dark') ? 'dark' : 'light';
      localStorage.setItem('theme', theme);
    });

    // Mobile menu functionality (if needed, add mobile menu structure in HTML)
    const mobileMenuButton = document.querySelector('.mobile-menu-button');
    const mobileMenu = document.querySelector('.mobile-menu');
    const overlay = document.querySelector('.overlay');
    const mobileMenuClose = document.querySelector('.mobile-menu-close');

    if (mobileMenuButton && mobileMenu && overlay && mobileMenuClose) {
      mobileMenuButton.addEventListener('click', () => {
        mobileMenu.classList.add('open');
        overlay.classList.add('open');
        document.body.style.overflow = 'hidden';
      });

      function closeMenu() {
        mobileMenu.classList.remove('open');
        overlay.classList.remove('open');
        document.body.style.overflow = '';
      }

      mobileMenuClose.addEventListener('click', closeMenu);
      overlay.addEventListener('click', closeMenu);
    }
  </script>

  <!-- Page-specific JS -->
  {% if request.endpoint == 'image_bp.search' %}
  <script src="{{ url_for('static', filename='js/search.js') }}"></script>
  {% elif request.endpoint == 'image_bp.gallery' %}
  <script src="{{ url_for('static', filename='js/gallery.js') }}"></script>
  {% endif %}

</body>
</html>
