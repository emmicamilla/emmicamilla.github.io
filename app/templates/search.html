{% extends "base.html" %}

{% block title %}Search{% endblock %}

{% block content %}
<div class="container">
  <div class="card">
    <div class="card-header">
      <h1 class="card-title">Search IHC Images</h1>
      <p class="card-description">
        Use the filters below to search for immunohistochemistry images in our database.
      </p>
    </div>
    <div class="card-content">
      <form id="search-form" class="form-grid">
        <div class="filters-grid">
          <div class="form-group">
            <label for="staining">Staining</label>
              <select name="staining" id="staining">
                <option value="" selected disabled>Select staining</option>
              {% for s in stainings %}
                  <option value="{{ s }}">{{ s }}</option>
              {% endfor %}
              </select>
          </div>
          <div class="form-group">
            <label for="tissue">Tissue</label>
            <select name="tissue" id="tissue">
              <option value="" selected disabled>Select tissue</option>
              {% for t in tissues %}
                  <option value="{{ t }}">{{ t }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="form-group">
            <label for="diagnosis">Diagnosis</label>
            <select name="diagnosis" id="diagnosis">
              <option value="" selected disabled>Select diagnosis</option>
              {% for d in diagnoses %}
                  <option value="{{ d }}">{{ d }}</option>
              {% endfor %}
            </select>
          </div>
        </div>
        <div class="buttons">
          <button type="button" class="btn-outline" id="clear-btn">Clear</button>
          <button type="submit" class="btn-primary">Search</button>
        </div>
      </form>
    </div>
  </div>
</div>



  {% if search_done %}
  <div>
    <strong>Search criteria:</strong>
    {% if selected_stainings %}Staining: {{ selected_stainings | join(', ') }}{% endif %}
    {% if selected_tissues %}<br>Tissue: {{ selected_tissues | join(', ') }}{% endif %}
    {% if selected_diagnoses %}<br>Diagnosis: {{ selected_diagnoses | join(', ') }}{% endif %}
  </div>
  <div class="gallery">
    {% if images %}
      {% for img in images %}
        <img src="{{ url_for('image', image_id=img.id) }}" alt="{{ img.filename }}" width="200">
      {% endfor %}
    {% else %}
      <p>Ei kuvia l√∂ydetty</p>
    {% endif %}
  </div>
{% endif %}
{% endblock %}